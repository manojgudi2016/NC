<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<head>
<style>
  #dvLoading {
        background: url("/projects/sites/eng/_layouts/images/gears_an.gif") no-repeat center center;
        height: 100px;
        width: 100%;
    }
</style>

<script type="text/javascript" src="http://ishare.novachem.com/projects/sites/eng/SiteAssets/jquery-1.12.3.min.js"></script>
<script type='text/javascript'>
        var isInitialLoad =true;
        var currentSite ="";
        var groupInfo =new Array();
        var  url = window.location.href;
 		var projectNumberFromURL = url.substring(url.indexOf('/sites/eng')+11).split('/')[0];
 		//projectNumberFromURL  ="16542";
 		var siteURL ='/projects/sites/eng/'+projectNumberFromURL+'/';
 		
 	    var ProjectOwnersGroup =projectNumberFromURL + " Owners";
	    var ProjectManagersGroup =projectNumberFromURL + " Managers";
	    var ProjectMembersGroup =projectNumberFromURL + " Members";
	    var ProjectVisitorsGroup =projectNumberFromURL + " Visitors";
	    var ProjectStakeholdersGroup =projectNumberFromURL + " Stakeholders";
	    var ProjectReviewersGroup =projectNumberFromURL + " Project Reviewers";
	    var ProjectApproversGroup =projectNumberFromURL + " Project Approvers";
	    var ProjectFinalApproversGroup =projectNumberFromURL + " Project Final Approvers";
	    var ProjectFCMApproversGroup =projectNumberFromURL + " FCM Approvers";
	    var ProjectOHSAApproversGroup =projectNumberFromURL + " OHSA Approvers";
	    var ProjectRCApproversGroup =projectNumberFromURL + " RC Approvers";
	 
  	    var groups= new Array(ProjectOwnersGroup ,ProjectManagersGroup ,ProjectMembersGroup ,ProjectVisitorsGroup ,
	   						ProjectStakeholdersGroup ,ProjectReviewersGroup ,ProjectApproversGroup ,ProjectFinalApproversGroup ,ProjectFCMApproversGroup ,
	   						ProjectOHSAApproversGroup ,ProjectRCApproversGroup);
	   						
       
ExecuteOrDelayUntilScriptLoaded(retrieveAllGroups, 'sp.js'); //On Page load all the groups will be queried and stored in groupInfo Array
     
	/*  STEP 0 AGet all Site Groups */
		function retrieveAllGroups() {
		       $('#dvLoading').hide();
		    var clientContext = new SP.ClientContext(siteURL);
		    this.collGroup = clientContext.get_web().get_siteGroups();
		    clientContext.load(collGroup);
		    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded1), Function.createDelegate(this, this.onQueryFailed));
		}

		function onQuerySucceeded1() {
		    var groupEnumerator = collGroup.getEnumerator();
		    while (groupEnumerator.moveNext())
		     {
			      for(var i = 0; i < groups.length; i++) 
				      { 
				        var ogroup = groupEnumerator.get_current();
					        if(groups[i] ==ogroup .get_title())
						        {
				 		                  groupInfo.push(ogroup .get_title()+'@'+ogroup .get_id()) ;
				 		                  //console.log(ogroup .get_title()+'@'+ogroup .get_id()) ;
				 		        }
				       }
		       }
		       if(!isInitialLoad)
		       {
		       $('#dvLoading').show();
		       setTimeout(createGroupAndAssignPermissionsOnLists1, 3000);
		       }
		}
      	
        
	/*  STEP 1 Assign Permissions on Lists  Create SharePoint Site Groups and assign permission on Libraries (JSOM doesnt allow many requests in one call, hence splitting one call for Libraries and Other for Lists.*/ 
	function createGroupAndAssignPermissionsOnLibraries() {
		    $('#dvLoading').show();
		    var clientContext = new SP.ClientContext(siteURL);
		    this.oWebsite = clientContext.get_web();
		    
		     //Libraries
		    this.constructionLibrary= clientContext.get_web().get_lists().getByTitle('Construction Library');
		    constructionLibrary.breakRoleInheritance(false, true);
		    
		    this.fcmConsolidatedLibrary = clientContext.get_web().get_lists().getByTitle('FCM Consolidated Reports');
		    fcmConsolidatedLibrary.breakRoleInheritance(false, true);
		
		    this.fcmLibrary = clientContext.get_web().get_lists().getByTitle('FCM Library');
		    fcmLibrary .breakRoleInheritance(false, true);
		    
		    this.pcrLibrary = clientContext.get_web().get_lists().getByTitle('Project Consolidated Reports');
		    pcrLibrary.breakRoleInheritance(false, true);
		
		    this.projectLibrary = clientContext.get_web().get_lists().getByTitle('Project Library');
		    projectLibrary.breakRoleInheritance(false, true);
		
		    this.restProjDocLibrary = clientContext.get_web().get_lists().getByTitle('Restricted Project Documentation');
		    restProjDocLibrary.breakRoleInheritance(false, true);
		   
		    this.scheduleLibrary = clientContext.get_web().get_lists().getByTitle('Schedule Library');
		    scheduleLibrary.breakRoleInheritance(false, true);
		    
    
	  	  //Before assigning permissions, check if the groups are existing, same group names might exist at the root site.
		    var siteGroupId=0;  
	    for(var i = 0; i < groups.length; i++) 
	    { 
		      	 	  var isGroupExist = false;
		      		  //Check If the Group is already existing
			        for(var j=0;j<groupInfo.length;j++)
			        {
				          if(groups[i]==groupInfo[j].split('@')[0])
					          {
						           // console.log( groups[i] +' already existed');
						            isGroupExist =true;
						            siteGroupId = groupInfo[j].split('@')[1];
						            //Need to see what to do if site groups already exists at Root Site level.
					         }  
				}

		    //Need to check, if the group already exists what needs to be done? Should delete from root site and recreate?
		     //  Group Creation
		     if(! isGroupExist)
		     {
		       var groupCreationInfo = new SP.GroupCreationInformation();
			groupCreationInfo.set_title(groups[i]);
			groupCreationInfo.set_description(' ');
			this.oGroup = oWebsite.get_siteGroups().add(groupCreationInfo);
			}
			else
			{
			this.oGroup = oWebsite.get_siteGroups().getById(siteGroupId);
			}
	  
	 		    //RoleDefinition
			    var collRoleDefinitionBinding = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Site
			    var collRoleDefinitionBindingPL = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Project Library
			    var collRoleDefinitionBindingFL = SP.RoleDefinitionBindingCollection.newObject(clientContext); //FCM Library			    
			    var collRoleDefinitionBindingCL = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Construction Library
			    var collRoleDefinitionBindingFCR = SP.RoleDefinitionBindingCollection.newObject(clientContext); //FCM Consolidated Reports 
			    var collRoleDefinitionBindingPCR = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Project Consolidated Reports  
			    var collRoleDefinitionBindingRPD = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Restricted Project Documentation  
			    var collRoleDefinitionBindingSL = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Schedule Library  
				   
				 if(groups[i]==ProjectOwnersGroup)
			    {
				       this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
				       this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
				       this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
				       this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
					this.oRoleDefinitionRPD= oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
				
			        }
		        else if(groups[i]==ProjectManagersGroup)
			    {
				    this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
				        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
				        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
				        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionRPD= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
				    }
		        else if(groups[i]==ProjectMembersGroup)
			    {
				    this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			           this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
			           this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute		
			           this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
								        	        
			    }
			    else if(groups[i]==ProjectVisitorsGroup)
			    {
			        this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
					    }
			    else if(groups[i]==ProjectStakeholdersGroup)
			    {
					this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			    } 
			    else if(groups[i]==ProjectReviewersGroup)
			    {
					this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			    }
                else if(groups[i]==ProjectApproversGroup)
			    {
					this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			    }
				else if(groups[i]==ProjectFinalApproversGroup)
			    {
					this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
				
			    }
				else if(groups[i]==ProjectFCMApproversGroup)
			    {
			    	this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			    }
				else if(groups[i]==ProjectOHSAApproversGroup)
			    {
			    	this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			    
			    }
				else if(groups[i]==ProjectRCApproversGroup)
			    {
			    	this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			    }
			/*	else
		        {
			        this.oRoleDefinition= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionPL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionFL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
			        this.oRoleDefinitionCL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
					this.oRoleDefinitionFCR = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
					this.oRoleDefinitionPCR= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
					this.oRoleDefinitionSL= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
	  		    } */
		        
			       collRoleDefinitionBinding.add(oRoleDefinition);
			       collRoleDefinitionBindingPL.add(oRoleDefinitionPL);
    			       collRoleDefinitionBindingFL.add(oRoleDefinitionFL);
    			       collRoleDefinitionBindingCL.add(oRoleDefinitionCL); 
				collRoleDefinitionBindingFCR.add(oRoleDefinitionFCR);
				collRoleDefinitionBindingPCR.add(oRoleDefinitionPCR);
				collRoleDefinitionBindingRPD.add(oRoleDefinitionRPD);
				collRoleDefinitionBindingSL.add(oRoleDefinitionSL); 
		         
			        //Role Assignment
			        var collRollAssignment = oWebsite.get_roleAssignments();
			        var collRollAssignmentPL = projectLibrary.get_roleAssignments();
			        var collRollAssignmentFL = fcmLibrary.get_roleAssignments();
			        var collRollAssignmentCL = constructionLibrary.get_roleAssignments();	
				var	collRollAssignmentFCR  =fcmConsolidatedLibrary.get_roleAssignments();	 
				var	collRollAssignmentPCR=pcrLibrary.get_roleAssignments();
				var	collRollAssignmentRPD=restProjDocLibrary.get_roleAssignments();
				var	collRollAssignmentSL=scheduleLibrary.get_roleAssignments();
		    
		              collRollAssignment.add(oGroup, collRoleDefinitionBinding);
		              collRollAssignmentPL.add(oGroup, collRoleDefinitionBindingPL);               
		              collRollAssignmentFL.add(oGroup, collRoleDefinitionBindingFL);
		              collRollAssignmentCL.add(oGroup, collRoleDefinitionBindingCL);
				collRollAssignmentFCR  .add(oGroup, collRoleDefinitionBindingFCR);
				collRollAssignmentPCR.add(oGroup, collRoleDefinitionBindingPCR);
				collRollAssignmentRPD.add(oGroup, collRoleDefinitionBindingRPD);
				collRollAssignmentSL.add(oGroup, collRoleDefinitionBindingSL);
				   			    
			        //Load Group and its Role definition to context
			        clientContext.load(oGroup , 'Title');
			        clientContext.load(oRoleDefinition, 'Name');
				 clientContext.load(oRoleDefinitionFL,'Name');
			  	 clientContext.load(oRoleDefinitionCL,'Name');
				 clientContext.load(oRoleDefinitionFCR,'Name');
			 	 clientContext.load(oRoleDefinitionPCR,'Name');
			 	 clientContext.load(oRoleDefinitionSL,'Name');
			 	 
      } //End of for loop
    clientContext.executeQueryAsync(
        Function.createDelegate(this, this.onQuerySucceededLibrary), 
        Function.createDelegate(this, this.onQueryFailed));
}

function onQuerySucceededLibrary() {
       	//console.log('Success:   Permissions Assigned On Libraries Successfully');
       	$('#tblLibraries .ms-vb').css('color', 'green');
       	isInitialLoad =false;
       	setTimeout(retrieveAllGroups, 3000);
     }

function onQuerySucceededList1() {
       	//console.log('Success:   Permissions Assigned On Lists(1) Successfully');
       	 $('#tblLists1 .ms-vb').css('color', 'green');
       	createGroupAndAssignPermissionsOnLists2();
      }
	
function onQuerySucceededList2() {
       	//console.log('Success:   Permissions Assigned On Lists(2) Successfully');
       	$('#tblLists2 .ms-vb').css('color', 'green');
       	$('#dvLoading').hide();
       	$('#dvStatusMessage').text('Permissions assigned successfully');
       	}

function onQueryFailed(sender, args) {
           $('#dvLoading').hide();
            $('#dvStatusMessage').text('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
            $('#dvStatusMessage').css('color','red');
	    }
	
	
	/*  STEP 2 Assign Permissions on Half of the Lists  */
	function createGroupAndAssignPermissionsOnLists1() {
					    $('#dvLoading').show();
					    var clientContext = new SP.ClientContext(siteURL);
					    this.oWebsite = clientContext.get_web();
					
					    this.actionDecisionLogList = clientContext.get_web().get_lists().getByTitle('Action Decision Log');
					    actionDecisionLogList.breakRoleInheritance(false, true);
					
					    this.calendarList= clientContext.get_web().get_lists().getByTitle('Calendar');
					    calendarList.breakRoleInheritance(false, true);
					    
					    this.meetingsList= clientContext.get_web().get_lists().getByTitle('Meetings');
					    meetingsList.breakRoleInheritance(false, true);
					    
					    this.teamDiscussionsList= clientContext.get_web().get_lists().getByTitle('Team Discussions');
					    teamDiscussionsList.breakRoleInheritance(false, true);
					
					    this.projWFStagesList = clientContext.get_web().get_lists().getByTitle('Project Workflow Stages');
					    projWFStagesList.breakRoleInheritance(false, true);
					
					    this.fcmWFStagesList = clientContext.get_web().get_lists().getByTitle('FCM Workflow Stages');
					    fcmWFStagesList .breakRoleInheritance(false, true);
					
					    this.projApprovalTasksList = clientContext.get_web().get_lists().getByTitle('Project Approval Stages WF Tasks');
					    projApprovalTasksList.breakRoleInheritance(false, true);
					
					    this.fcmApprovalTasksList = clientContext.get_web().get_lists().getByTitle('FCM Approval Stages WF Tasks');
					    fcmApprovalTasksList.breakRoleInheritance(false, true);
					
					    this.projReviewTaskList = clientContext.get_web().get_lists().getByTitle('Project Feedback WF Tasks');
					    projReviewTaskList.breakRoleInheritance(false, true);
					
		    
			    //Before assigning permissions, check if the groups are existing, same group names might exist at the root site.
			    var siteGroupId=0;  
		    for(var i = 0; i < groups.length; i++) 
		    { 
				      	 	  var isGroupExist = false;
				      		  //Check If the Group is already existing
					        for(var j=0;j<groupInfo.length;j++)
					        {
						          if(groups[i]==groupInfo[j].split('@')[0])
							          {
								         //   console.log( groups[i] +' already existed');
								            isGroupExist =true;
								            siteGroupId = groupInfo[j].split('@')[1];
								            //Need to see what to do if site groups already exists at Root Site level.
							         }  
						}
						
/*					 var groupCreationInfo = new SP.GroupCreationInformation();
					groupCreationInfo.set_title(groups[i]);
					groupCreationInfo.set_description(' ');
					this.oGroup = oWebsite.get_siteGroups().add(groupCreationInfo);*/
					this.oGroup = oWebsite.get_siteGroups().getById(siteGroupId);

						 if(groups[i]==ProjectOwnersGroup)
					    {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control  
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control

				        }
				        else if(groups[i]==ProjectManagersGroup)
					    {
							
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute		  				        
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
					    }
				        else if(groups[i]==ProjectMembersGroup)
					    {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
		    				       this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute       
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read							
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					    }
					    else if(groups[i]==ProjectVisitorsGroup)
					    {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read							
							this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute  
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read																																			
					    }
					    else if(groups[i]==ProjectStakeholdersGroup)
					    {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
    		    				       this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute		     							
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute														    		    				       
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					    } 
					    else if(groups[i]==ProjectReviewersGroup)
					    {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
		    				       this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute		 		    
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
														

					    }
		                else if(groups[i]==ProjectApproversGroup)
					    {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
		    				       this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute		 		    
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					    }
						else if(groups[i]==ProjectFinalApproversGroup)
					    {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
		    				       this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute		 		    
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
		 	    
					    }
						else if(groups[i]==ProjectFCMApproversGroup)
					    {
						this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
		    				       this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute		 		    
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
 
					    }
						else if(groups[i]==ProjectOHSAApproversGroup)
					    {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
		    				       this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute		 		    
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					    
					    }
						else if(groups[i]==ProjectRCApproversGroup)
					    {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute							
		    				       this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute		 		    
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
					    
					    }
					/*	else
				        {
							this.oRoleDefinitionADL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionCAL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMeeting = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read							
		    				       this.oRoleDefinitionDiscussionList= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read		 		    
							this.oRoleDefinitionProjWFStages = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMWFStage = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMAppStageWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjFeedWFTask = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
 
			  		    }*/
			  		    
			  		      //RoleDefinition
					    var collRoleDefinitionBindingADL = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Action Decision Log 				    			    
					    var collRoleDefinitionBindingCAL = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Calendar  
					    var collRoleDefinitionBindingMeeting = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Meetings  
					    var collRoleDefinitionBindingDiscussionList = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Discussion List
		  			    var collRoleDefinitionBindingProjWFStages = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Project Workflow Stages   					    		   			    
					    var collRoleDefinitionBindingFCMWFStage = SP.RoleDefinitionBindingCollection.newObject(clientContext); //FCM Workflow Stages  
					    var collRoleDefinitionBindingProjAppStageWFTask = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Project Approval Stages WF Tasks  
					    var collRoleDefinitionBindingFCMAppStageWFTask = SP.RoleDefinitionBindingCollection.newObject(clientContext); //FCM Approval Stages WF Tasks
					    var collRoleDefinitionBindingProjFeedWFTask = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Project Feedback WF Tasks  				    
					    
		   			     //Role Assignment
						var	collRollAssignmentADL=actionDecisionLogList.get_roleAssignments();
						var	collRollAssignmentCAL=calendarList.get_roleAssignments();
						var	collRollAssignmentMeeting=meetingsList.get_roleAssignments();
						var	collRollAssignmentDiscussionList=teamDiscussionsList.get_roleAssignments();
						var	collRollAssignmentProjWFStagesList=projWFStagesList.get_roleAssignments();
						var	collRollAssignmentFcmWFStagesList=fcmWFStagesList.get_roleAssignments();
						var	collRollAssignmentProjApprovalTasksList=projApprovalTasksList.get_roleAssignments();
						var	collRollAssignmentFcmApprovalTasksList=fcmApprovalTasksList.get_roleAssignments();
						var	collRollAssignmentProjReviewTaskList=projReviewTaskList.get_roleAssignments();
		
						collRoleDefinitionBindingADL.add(oRoleDefinitionADL);
						collRoleDefinitionBindingCAL.add(oRoleDefinitionCAL);
						collRoleDefinitionBindingMeeting .add(oRoleDefinitionMeeting);
						collRoleDefinitionBindingDiscussionList .add(oRoleDefinitionDiscussionList);
						collRoleDefinitionBindingProjWFStages.add(oRoleDefinitionProjWFStages); 
						collRoleDefinitionBindingFCMWFStage.add(oRoleDefinitionFCMWFStage); 
						collRoleDefinitionBindingProjAppStageWFTask .add(oRoleDefinitionProjAppStageWFTask);
						collRoleDefinitionBindingFCMAppStageWFTask.add(oRoleDefinitionFCMAppStageWFTask); 
						collRoleDefinitionBindingProjFeedWFTask .add(oRoleDefinitionProjFeedWFTask);
						
						collRollAssignmentADL.add(oGroup, collRoleDefinitionBindingADL);
						collRollAssignmentCAL.add(oGroup, collRoleDefinitionBindingCAL);
						collRollAssignmentMeeting.add(oGroup, collRoleDefinitionBindingMeeting);
						collRollAssignmentDiscussionList.add(oGroup, collRoleDefinitionBindingDiscussionList );
						collRollAssignmentProjWFStagesList.add(oGroup, collRoleDefinitionBindingProjWFStages);
						collRollAssignmentFcmWFStagesList.add(oGroup, collRoleDefinitionBindingFCMWFStage);
						collRollAssignmentProjApprovalTasksList.add(oGroup, collRoleDefinitionBindingProjAppStageWFTask);
						collRollAssignmentFcmApprovalTasksList.add(oGroup, collRoleDefinitionBindingFCMAppStageWFTask);
						collRollAssignmentProjReviewTaskList.add(oGroup, collRoleDefinitionBindingProjFeedWFTask);
					

						 //var group = this.oWebsite.get_siteGroups().getById(siteGroupId);		
						   			    
					        //Load Group and its Role definition to context
					        clientContext.load(oGroup , 'Title');
					        
					        clientContext.load(oRoleDefinitionADL , 'Name');
					        clientContext.load(oRoleDefinitionCAL , 'Name');
					        clientContext.load(oRoleDefinitionMeeting , 'Name');
					        clientContext.load(oRoleDefinitionDiscussionList, 'Name');						        					        
					        clientContext.load(oRoleDefinitionProjWFStages , 'Name');
					        clientContext.load(oRoleDefinitionFCMWFStage , 'Name');					        
					        clientContext.load(oRoleDefinitionProjAppStageWFTask , 'Name');
					        clientContext.load(oRoleDefinitionFCMAppStageWFTask , 'Name');
					        clientContext.load(oRoleDefinitionProjFeedWFTask , 'Name');					        
					        
      } //End of for loop
    clientContext.executeQueryAsync(
        Function.createDelegate(this, this.onQuerySucceededList1), 
        Function.createDelegate(this, this.onQueryFailed));

}

/*  STEP 3 Assign Permissions on Half of the Lists  */
	function createGroupAndAssignPermissionsOnLists2() {
							    $('#dvLoading').show();
					    var clientContext = new SP.ClientContext(siteURL);
					    this.oWebsite = clientContext.get_web();
					
					   this.teamMembersList = clientContext.get_web().get_lists().getByTitle('TeamMembers');
					    teamMembersList .breakRoleInheritance(false, true);
					
					    this.stakeholdersList= clientContext.get_web().get_lists().getByTitle('Stakeholders');
					    stakeholdersList.breakRoleInheritance(false, true);
					
					    this.deliverablesList= clientContext.get_web().get_lists().getByTitle('Deliverables');
					    deliverablesList.breakRoleInheritance(false, true);
					
					    this.commentsLogList = clientContext.get_web().get_lists().getByTitle('Comments Log');
					    commentsLogList.breakRoleInheritance(false, true);
					
					    this.commentsLogTempList = clientContext.get_web().get_lists().getByTitle('Comment Log Temp');
					    commentsLogTempList .breakRoleInheritance(false, true);
					    
					    this.MPLList = clientContext.get_web().get_lists().getByTitle('Master Project List');
					    MPLList .breakRoleInheritance(false, true);
					
					    this.FCMTempExtList= clientContext.get_web().get_lists().getByTitle('FCM Temporary Extension');
					    FCMTempExtList.breakRoleInheritance(false, true);
					
					    this.ProjImageList= clientContext.get_web().get_lists().getByTitle('Project Image');
					    ProjImageList.breakRoleInheritance(false, true);
					
					    this.siteImageList= clientContext.get_web().get_lists().getByTitle('Site Image');
					    siteImageList.breakRoleInheritance(false, true);

		  		 	    
		    
			    //Before assigning permissions, check if the groups are existing, same group names might exist at the root site.
			    var siteGroupId=0;  
		    for(var i = 0; i < groups.length; i++) 
		    { 
				      	 	  var isGroupExist = false;
				      		  //Check If the Group is already existing
					        for(var j=0;j<groupInfo.length;j++)
					        {
						          if(groups[i]==groupInfo[j].split('@')[0])
							          {
								          //  console.log( groups[i] +' already existed');
								            isGroupExist =true;
								            siteGroupId = groupInfo[j].split('@')[1];
								            //Need to see what to do if site groups already exists at Root Site level.
							         }  
						}
						
			/* var groupCreationInfo = new SP.GroupCreationInformation();
			groupCreationInfo.set_title(groups[i]);
			groupCreationInfo.set_description(' ');
			this.oGroup = oWebsite.get_siteGroups().add(groupCreationInfo);*/
			this.oGroup = oWebsite.get_siteGroups().getById(siteGroupId);

						 if(groups[i]==ProjectOwnersGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionComLogTemp = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.administrator); //For Full Control
				        }
				        else if(groups[i]==ProjectManagersGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionComLogTemp = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute	
					    }
				        else if(groups[i]==ProjectMembersGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionComLogTemp = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute	
					    }
					    else if(groups[i]==ProjectVisitorsGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionComLogTemp= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read	
					    }
					   else if(groups[i]==ProjectStakeholdersGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionComLogTemp= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read		
					    } 
					  else if(groups[i]==ProjectReviewersGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionComLogTemp= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read		
					    }
		                  else if(groups[i]==ProjectApproversGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionComLogTemp= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read		
					    }
						else if(groups[i]==ProjectFinalApproversGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionComLogTemp= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read		
					    }
						else if(groups[i]==ProjectFCMApproversGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionComLogTemp= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read		
					    }
						else if(groups[i]==ProjectOHSAApproversGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionComLogTemp= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read		
					    }
						else if(groups[i]==ProjectRCApproversGroup)
					    {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionComLogTemp= oWebsite.get_roleDefinitions().getByType(SP.RoleType.contributor); //For Contribute
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read		
					    }
					/*	else
				        {
							this.oRoleDefinitionComLog = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionComLogTemp= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionDeliverables = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionStakeholder = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionTeamMem = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionMPL = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionProjImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionSiteImg = oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read
							this.oRoleDefinitionFCMTempExt= oWebsite.get_roleDefinitions().getByType(SP.RoleType.reader); //For Read		
			  		    }*/
			  		    
			  		    //RoleDefinition
					    var collRoleDefinitionBindingDeliverables = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Deliverables 
		   			    var collRoleDefinitionBindingStakeholder = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Stakeholders    
		   			    var collRoleDefinitionBindingTeamMem = SP.RoleDefinitionBindingCollection.newObject(clientContext); //TeamMembers   
   		   			   var collRoleDefinitionBindingComLogTemp = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Comment Log Temp  
					    var collRoleDefinitionBindingComLog = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Comments Log      
		   			    var collRoleDefinitionBindingMPL = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Master Project List  
		   			    var collRoleDefinitionBindingProjImg = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Project Image  			    
		   			    var collRoleDefinitionBindingSiteImg = SP.RoleDefinitionBindingCollection.newObject(clientContext); //Site Image  			    
		   			    var collRoleDefinitionBindingFCMTempExt = SP.RoleDefinitionBindingCollection.newObject(clientContext); //FCM Temporary Extension   
		   			    
		   			    
		   			            //Role Assignment
						var	collRollAssignmentTeamMembersList=teamMembersList.get_roleAssignments();
						var	collRollAssignmentStakeholdersList=stakeholdersList.get_roleAssignments();
						var	collRollAssignmentDeliverablesList=deliverablesList.get_roleAssignments();
						var	collRollAssignmentCommentsLogList=commentsLogList.get_roleAssignments();
						var	collRollAssignmentCommentsLogTempList=commentsLogTempList.get_roleAssignments();
						var	collRollAssignmentMPLList=MPLList .get_roleAssignments();
						var	collRollAssignmentFCMTempExtList=FCMTempExtList.get_roleAssignments();				
						var	collRollAssignmentProjImageList=ProjImageList.get_roleAssignments();				
						var	collRollAssignmentsiteImageList=siteImageList.get_roleAssignments();		
		
						collRoleDefinitionBindingComLogTemp.add(oRoleDefinitionComLogTemp); 
						collRoleDefinitionBindingComLog.add(oRoleDefinitionComLog); 
						collRoleDefinitionBindingDeliverables.add(oRoleDefinitionDeliverables); 
						collRoleDefinitionBindingStakeholder .add(oRoleDefinitionStakeholder);
						collRoleDefinitionBindingTeamMem .add(oRoleDefinitionTeamMem);
						collRoleDefinitionBindingMPL .add(oRoleDefinitionMPL);
						collRoleDefinitionBindingProjImg .add(oRoleDefinitionProjImg);
						collRoleDefinitionBindingSiteImg .add(oRoleDefinitionSiteImg);
						collRoleDefinitionBindingFCMTempExt .add(oRoleDefinitionFCMTempExt);
				 
						collRollAssignmentTeamMembersList.add(oGroup, collRoleDefinitionBindingTeamMem );
						collRollAssignmentStakeholdersList.add(oGroup, collRoleDefinitionBindingStakeholder);
						collRollAssignmentDeliverablesList.add(oGroup, collRoleDefinitionBindingDeliverables);
						collRollAssignmentCommentsLogList.add(oGroup, collRoleDefinitionBindingComLog);
						collRollAssignmentCommentsLogTempList.add(oGroup, collRoleDefinitionBindingComLogTemp);
						collRollAssignmentMPLList.add(oGroup, collRoleDefinitionBindingMPL);
						collRollAssignmentFCMTempExtList.add(oGroup, collRoleDefinitionBindingProjImg );								
						collRollAssignmentProjImageList.add(oGroup, collRoleDefinitionBindingSiteImg );				
						collRollAssignmentsiteImageList.add(oGroup, collRoleDefinitionBindingFCMTempExt);

					        //Load Group and its Role definition to context
					        clientContext.load(oGroup , 'Title');
					        
					        clientContext.load(oRoleDefinitionComLog , 'Name');
					        clientContext.load(oRoleDefinitionComLogTemp , 'Name');
					        clientContext.load(oRoleDefinitionDeliverables , 'Name');
					        clientContext.load(oRoleDefinitionStakeholder , 'Name');
					        clientContext.load(oRoleDefinitionTeamMem , 'Name');
					        clientContext.load(oRoleDefinitionMPL , 'Name');
					        clientContext.load(oRoleDefinitionSiteImg , 'Name');
					        clientContext.load(oRoleDefinitionTeamMem , 'Name');
					        clientContext.load(oRoleDefinitionFCMTempExt, 'Name');
					        
	
      } //End of for loop
    clientContext.executeQueryAsync(
        Function.createDelegate(this, this.onQuerySucceededList2), 
        Function.createDelegate(this, this.onQueryFailed));

}

</script>
<title></title>
<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:FSObjType msdt:dt="string">0</mso:FSObjType>
<mso:Order msdt:dt="string">14700.0000000000</mso:Order>
<mso:FileDirRef msdt:dt="string">projects/sites/eng/Track4/SiteAssets</mso:FileDirRef>
<mso:ContentTypeId msdt:dt="string">0x010100E0D83936C258F747958044C6BE311628</mso:ContentTypeId>
<mso:ContentType msdt:dt="string">Document</mso:ContentType>
<mso:FileLeafRef msdt:dt="string">AssignPermissions.html</mso:FileLeafRef>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>
<body>

<div style="width:80%;text-align:right">
<input type="button" id="btn1"  value="Assign Permissions" onclick="createGroupAndAssignPermissionsOnLibraries()">
<br  />
<br  />
The following libraries and lists will be assigned groups and permissions!
<br  />
<br  />
<br  />
<br  />
</div>

<table border="0" width="80%" cellpadding="2" cellspacing="0" style="border-left-width: 0px; border-right-width: 0px;" id="tblHeader">
   <tbody>
      <tr valign="top">
         <th class="ms-vh" nowrap="" style="width: 50%; text-align: center; border-bottom-style: solid; border-bottom-width: 1px;">Type</th>
         <th class="ms-vh" nowrap="" style="width: 50%; text-align: center; border-bottom-style: solid; border-bottom-width: 1px;">Title</th>
      </tr>
   </tbody>
</table>

<table border="0" width="80%" cellpadding="2" cellspacing="0" style="border-left-width: 0px; border-right-width: 0px;" id="tblLibraries">
  <tbody>
      <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> Library </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> Construction Library</td>
      </tr>		
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> Library </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">FCM Consolidated Reports</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> Library </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">FCM Library</td>
      </tr>	
      <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> Library </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Project Consolidated Reports</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> Library </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Project Library</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> Library </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Restricted Project Documentation</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> Library </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Schedule Library</td>
      </tr>	
         </tbody>
</table>


<table border="0" width="80%" cellpadding="2" cellspacing="0" style="border-left-width: 0px; border-right-width: 0px;" id="tblLists1">
  <tbody>
      <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Action Decision Log</td>
      </tr>		
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Calendar</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Meetings</td>
      </tr>	
      <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Team Discussions</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Project Workflow Stages</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">FCM Workflow Stages</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Project Approval Stages WF Tasks</td>
      </tr>	
             <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">FCM Approval Stages WF Tasks</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Project Feedback WF Tasks</td>
      </tr>	
         </tbody>
</table>

<table border="0" width="80%" cellpadding="2" cellspacing="0" style="border-left-width: 0px; border-right-width: 0px" id="tblLists2">
  <tbody>
      <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">TeamMembers</td>
      </tr>		
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Stakeholders</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Deliverables</td>
      </tr>	
      <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Comments Log</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Comment Log Temp</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Master Project List</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">FCM Temporary Extension</td>
      </tr>	
             <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Project Image</td>
      </tr>	
       <tr class="ms-alternating">
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;"> List </td>
		<td class="ms-vb" style="border-style: solid; border-width: 1px; width: 145px; text-align: center;">Site Image</td>
      </tr>	
         </tbody>
</table>
<br />
  <div id="dvLoading" style="height: 100px;width: 80%;" >  </div>
  <div id="dvStatusMessage" style="height: 100px;    width: 80%;    text-align: right;    font-size: large;    color: green;"  >  </div>
</body>
</html>
